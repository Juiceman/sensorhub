
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2015-09-25
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>SensorHub Core &#x2013; Sensor API</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />
 
		<link href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/spacelab/bootstrap.min.css" rel="stylesheet" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="../css/bootswatch.css" rel="stylesheet" />
		<link href="../css/reflow-skin.css" rel="stylesheet" />

		<link href="http://yandex.st/highlightjs/7.5/styles/default.min.css" rel="stylesheet" />

		<link href="../css/lightbox.css" rel="stylesheet" />

		<link href="../css/site.css" rel="stylesheet" />
		<link href="../css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
<link rel="icon" href="../images/favicon.ico?v=1"/>
		<!-- Google Analytics -->
		<script type="text/javascript">

			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-5799482-4']);
			_gaq.push(['_trackPageview']);

			(function() {
				var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();

		</script>
		</head>

	<body class="page-sensor-api project-sensorhub-core" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<div class="brand">OpenSensorHub</div>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="https://github.com/sensiasoft/sensorhub/tree/master" title="GitHub" class="externalLink">GitHub</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="../download.html" title="Download">Download</a></li>
									<li ><a href="../install.html" title="Install">Install</a></li>
									<li ><a href="../dev-guide.html" title="Dev Guide">Dev Guide</a></li>
									<li ><a href="apidocs/index.html" title="Javadocs">Javadocs</a></li>
									<li ><a href="your-first-sensor.html" title="First Sensor Driver">First Sensor Driver</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Components <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="index.html" title="Core APIs">Core APIs</a></li>
									<li ><a href="../sensorhub-service-swe/index.html" title="SWE Services">SWE Services</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="http://www.opensensorhub.org/" id="bannerLeft"><h1>Open Sensor Hub</h1></a>
					<p class="lead">Software For Building Smart Sensor Networks</p>
				</div>
				<div class="pull-right">
					<div id="bannerRight"><img src="../images/logo.png" alt='"''"' /></div>
				</div>
			</div>
		</div>
	</div>
		<div>
			<ul class="breadcrumb">
				<li><a href="../index.html" title="OpenSensorHub">OpenSensorHub</a></li>
				<li class="divider">/</li>
				<li><a href="./" title="SensorHub Core">SensorHub Core</a></li>
				<li class="divider">/</li>
				<li>Sensor API</li>
			</ul>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="Sensor_API">Sensor API</h2>
 </div> 
 <div class="section"> 
  <h3 id="Introduction">Introduction</h3> 
  <p>This page presents the API that one needs to implement to add support for new sensors or actuators. Each new driver is composed of at least 4 classes: - An implementation of <tt>ISensorModule</tt> - Zero or more implementations of <tt>ISensorDataInterface</tt> (<i>at least one for a sensor</i>) - Zero or more implementations of <tt>ISensorControlInterface</tt> (<i>at least one for an actuator</i>) - An extension of <i>SensorConfig</i> - An implementation of <tt>IModuleDescriptor</tt></p> 
  <p><i>Note: Several sensor drivers can be packaged in a single Maven module, although we encourage this only if the drivers are very closely related and/or have tight inter-dependencies.</i></p> 
  <p>Details about the different interfaces are given in the next sections.</p> 
 </div> 
 <div class="section"> 
  <h3 id="ISensorModule">ISensorModule</h3> 
  <p>The <a class="externalLink" href="https://github.com/sensiasoft/sensorhub/blob/master/sensorhub-core/src/main/java/org/sensorhub/api/sensor/ISensorModule.java"><tt>ISensorModule</tt></a> interface is the top-level one to be implemented by sensor drivers. It provides methods for: - Getting the SensorML description of an installed sensor or actuator - Updating the SensorML description (i.e. the part not auto-generated by the driver) - Checking for the presence of the device - Subscribing for high level sensor events (activation, connection, etc.) - Giving access to the sensor measurement outputs and control inputs</p> 
  <p>The main functions of the sensor module are shown on the figure below:</p> 
  <p><img src="images/sensor_module.png" alt="fig1" /></p> 
  <p>Each data interface is an output that gives access to a stream of sensor measurements and is an implementation of <a href="#ISensorDataInterface"><tt>ISensorDataInterface</tt></a>. Data interfaces are asynchornous in the sense that each of them can produce data at a different rate.</p> 
  <p>Each control interface is an input that can receive commands and is an implementation of <a href="#ISensorControlInterface"><tt>ISensorControlInterface</tt></a>. Each control input can receive different types of command messages.</p> 
  <p>A sensor module implementation must also provide the description of the sensor as a SensorML process (any class derived from <tt>AbstractProcess</tt> is acceptable). Usually, this sensor description is a mix between information auto-generated by the driver and information provided as a SensorML file by the user. Versioning and updating the sensor description can be optionnally supported by the driver.</p> 
  <p>In order to help you implement the API, we provide the <a href="#AbstractSensorModule"><tt>AbstractSensorModule</tt></a> class that is a simple partial implementation of <tt>ISensorModule</tt> and can be used as the base for most sensor modules. It provides default implementations of most methods in the API.</p> 
 </div> 
 <div class="section"> 
  <h3 id="ISensorDataInterface">ISensorDataInterface</h3> 
  <p>Data produced by each output must be made available by an implementation of <a class="externalLink" href="https://github.com/sensiasoft/sensorhub/blob/master/sensorhub-core/src/main/java/org/sensorhub/api/sensor/ISensorDataInterface.java"><tt>ISensorDataInterface</tt></a> that provides methods for: - Describing the data structure of each measurement record - Reading data produced by a sensor (poll mode) - Subscribing for data produced by a sensor (push mode) - Discovery methods allowing to advertise if push and storage are supported</p> 
  <p>The measurement record description must be provided as a tree of SWE Common data components (DataRecord, DataArray, Quantity, Time, Count, etc.). This structure will automatically be used to populate the output section of the SensorML description.</p> 
  <p>A recommended encoding must also be defined which is usually text for simple measurements and some binary flavor for imagery, video and other multi-dimensionnal datasets. </p> 
  <p>These components and encodings are provided by the <i>lib-swe-common</i> module.</p> 
  <p>All data streamed through the same data interface must be synchronous and time-tagged together.</p> 
  <p>The <a class="externalLink" href="https://github.com/sensiasoft/sensorhub/blob/master/sensorhub-core/src/main/java/org/sensorhub/impl/sensor/AbstractSensorOutput.java"><tt>AbstractSensorOutput</tt></a> class is provided to reduce redundant code and help you get started. It is a basic partial implementation of <tt>ISensorDataInterface</tt> that can be used as the base for most sensor modules.</p> 
 </div> 
 <div class="section"> 
  <h3 id="ISensorControlInterface">ISensorControlInterface</h3> 
  <p>Commands can be sent to the sensor via implementations of <a class="externalLink" href="https://github.com/sensiasoft/sensorhub/blob/master/sensorhub-core/src/main/java/org/sensorhub/api/sensor/ISensorControlInterface.java"><tt>ISensorControlInterface</tt></a> that provides methods for: - Sending commands to the sensor/actuator (synchronous or asynchronous) - Scheduling commands to be sent asynchronously and/or at specific times - Subscribing to events related to a command that is executed asynchronously</p> 
  <p>The <a class="externalLink" href="https://github.com/sensiasoft/sensorhub/blob/master/sensorhub-core/src/main/java/org/sensorhub/impl/sensor/AbstractSensorControl.java"><tt>AbstractSensorControl</tt></a> class is provided to reduce redundant code and help you get started. It is a basic partial implementation of <tt>ISensorControlInterface</tt> that can be used as the base for most sensor modules.</p> 
 </div> 
 <div class="section"> 
  <h3 id="SensorConfig">SensorConfig</h3> 
  <p>A configuration class derived from SensorConfig must be provided with the new driver. This class is used as a <i>struct</i> that contain public fields carrying the configuration of the sensor module.</p> 
  <p>All public fields in this class are used to automatically generate the administration user interface of this particular driver. Nesting configuration classes is supported.</p> 
 </div> 
 <div class="section"> 
  <h3 id="AbstractSensorModule">AbstractSensorModule</h3> 
  <p>The <a class="externalLink" href="https://github.com/sensiasoft/sensorhub/blob/master/sensorhub-core/src/main/java/org/sensorhub/impl/sensor/AbstractSensorModule.java"><tt>AbstractSensorModule</tt></a> class can serve as a base to develop most sensor drivers. It provides default implementation for the following aspects:</p> 
  <ul> 
   <li>Keeping maps of outputs and command inputs. Derived classes should thus call the <tt>addOutput()</tt> and <tt>addControlInput()</tt> methods</li> 
   <li>Generation of SensorML description (more details are given below)</li> 
  </ul> 
  <p>However, there is no default support for:</p> 
  <ul> 
   <li>Updating the sensor description from outside the driver (except by changing the base SensorML file)</li> 
   <li>Maintaining a history of sensor descriptions (this is because, by default, this feature is better handled by the persistence layer in SensorHub).</li> 
  </ul> 
  <p>Consequently, the <tt>AbstractSensorModule</tt> class returns <i>false</i> in the two methods reporting support of these functionalities.</p> 
  <div class="section"> 
   <h4 id="Default_workflow_for_generating_the_SensorML_description">Default workflow for generating the SensorML description</h4> 
   <p>The default workflow shown on the figure below illustrates the way the current sensor decription is generated when you derive a concrete driver implementation from <tt>AbstractSensorModule</tt>:</p> 
   <p><img src="images/sensorml_gen.png" alt="fig2" /></p> 
   <ol style="list-style-type: decimal"> 
    <li> <p>Output, control inputs and configuration parameter descriptions are actually defined by concrete driver implementation but appending to SensorML is done in <tt>AbstractSensorModule</tt></p></li> 
    <li> <p>Autogenerated content is usually info obtained directly from sensor hardware (e.g. serial number, etc.) and/or internal driver state (e.g. depending on commands received)</p></li> 
   </ol> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="IModuleDescriptor">IModuleDescriptor</h3> 
  <p>Like any SensorHub module, a sensor driver must implement a class derived from this interface to become discoverable.</p> 
 </div> 
</div>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#Sensor_API" title="Sensor API">Sensor API <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Introduction" title="Introduction">Introduction</a>
		<li><a href="#ISensorModule" title="ISensorModule">ISensorModule</a>
		<li><a href="#ISensorDataInterface" title="ISensorDataInterface">ISensorDataInterface</a>
		<li><a href="#ISensorControlInterface" title="ISensorControlInterface">ISensorControlInterface</a>
		<li><a href="#SensorConfig" title="SensorConfig">SensorConfig</a>
		<li class="dropdown"><a href="#AbstractSensorModule" title="AbstractSensorModule">AbstractSensorModule <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Default_workflow_for_generating_the_SensorML_description" title="Default workflow for generating the SensorML description">Default workflow for generating the SensorML description</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li><a href="#IModuleDescriptor" title="IModuleDescriptor">IModuleDescriptor</a>
				<li class="divider"></li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span1 bottom-nav">
					<ul class="nav nav-list">
					</ul>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2015 <a href="http://www.sensiasoftware.com">Sensia Software LLC</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 1.0. </span><span class="publishDate">Last Published: 2015-09-25. </span></p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="../js/lightbox.min.js"></script>
	<script src="../js/reflow-scroll.js"></script>
	<script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="../js/reflow-skin.js"></script>

	</body>
</html>
