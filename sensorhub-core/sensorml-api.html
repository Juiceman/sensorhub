
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2015-10-18
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>SensorHub Core &#x2013; SWE Common / SensorML API</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />
 
		<link href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/spacelab/bootstrap.min.css" rel="stylesheet" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="../css/bootswatch.css" rel="stylesheet" />
		<link href="../css/reflow-skin.css" rel="stylesheet" />

		<link href="http://yandex.st/highlightjs/7.5/styles/default.min.css" rel="stylesheet" />

		<link href="../css/lightbox.css" rel="stylesheet" />

		<link href="../css/site.css" rel="stylesheet" />
		<link href="../css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
<link rel="icon" href="../images/favicon.ico?v=1"/>
		<!-- Google Analytics -->
		<script type="text/javascript">

			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-5799482-4']);
			_gaq.push(['_trackPageview']);

			(function() {
				var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();

		</script>
		</head>

	<body class="page-sensorml-api project-sensorhub-core" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<div class="brand">OpenSensorHub</div>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="https://github.com/opensensorhub" title="GitHub" class="externalLink">GitHub</a></li>
							<li ><a href="../report-errors.html" title="Report an Error">Report an Error</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="../download.html" title="Download">Download</a></li>
									<li ><a href="../install.html" title="Install">Install</a></li>
									<li ><a href="../user-guide.html" title="User's Guide">User's Guide</a></li>
									<li ><a href="../dev-guide.html" title="Developer's Guide">Developer's Guide</a></li>
									<li ><a href="your-first-sensor.html" title="Your First Sensor Driver">Your First Sensor Driver</a></li>
									<li ><a href="apidocs/index.html" title="Javadocs">Javadocs</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Components <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="index.html" title="Core APIs">Core APIs</a></li>
									<li ><a href="../sensorhub-service-swe/index.html" title="SWE Services">SWE Services</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="http://www.opensensorhub.org/" id="bannerLeft"><h1>Open Sensor Hub</h1></a>
					<p class="lead">Software For Building Smart Sensor Networks</p>
				</div>
				<div class="pull-right">
					<div id="bannerRight"><img src="../images/logo.png" alt='"''"' /></div>
				</div>
			</div>
		</div>
	</div>
		<div>
			<ul class="breadcrumb">
				<li><a href="../index.html" title="Docs">Docs</a></li>
				<li class="divider">/</li>
				<li><a href="./" title="SensorHub Core">SensorHub Core</a></li>
				<li class="divider">/</li>
				<li>SWE Common / SensorML API</li>
			</ul>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="SWE_Common__SensorML_API">SWE Common / SensorML API</h2>
 </div> 
 <p>In SensorHub, sensor descriptions (or sensor metadata) are in the <a class="externalLink" href="http://www.opengeospatial.org/standards/sensorml">SensorML 2.0</a> format, an international open standard from the <a class="externalLink" href="http://www.opengeospatial.org">Open Geospatial Consortium (OGC)</a>. They are often generated (at least partly) from code using the java SensorML bindings included in <a class="externalLink" href="https://github.com/sensiasoft/lib-sensorml">lib-sensorml</a>.</p> 
 <p>These bindings are automatically generated from the 2.0 XML schemas and thus are a direct reflection of the types and properties that are defined by it. The general rule is that each <a class="externalLink" href="http://www.w3.org/TR/xmlschema-1/#Complex_Type_Definitions">XML Schema Complex Type</a> (except OGC Property Types) becomes a Java interface with appropriate methods to handle each property (get/set/isSet/unSet, getNum/add for multiplicity &gt; 1, etc.).</p> 
 <p>There is one subtle difference compared to other bindings that could be generated with commonly used tools such as JAXB or XML Beans: OGC Property Types are not generated as separate objects thus removing many unnecessary layers in the generated object tree. Instead, properties are handled as a generic <a class="externalLink" href="https://github.com/sensiasoft/lib-swe-common/blob/master/swe-common-core/src/main/java/net/opengis/OgcProperty.java"><i>OgcProperty</i></a> object, containing all info carried by the property such as name, xlink attributes, etc., and accessible via <i>‘getProperty’</i> methods. This means that calls to regular get methods would return the property value directly which makes constructing the object much more straight forward. This design allows for handling the entire content model from many OGC schemas without making the resulting object tree too complex.</p> 
 <p>Let’s look at examples of how to set different parts of a SensorML document using this API (All code in the following section assumes you have an instance of <i>PhysicalComponent</i> or <i>PhysicalSystem</i> called <i>‘system’</i> on hand).</p> 
 <p><i>Note: Most of the following examples are actually extracted from the ‘testGenerateInstance()’ method of this <a class="externalLink" href="https://github.com/sensiasoft/lib-sensorml/blob/master/sensorml-core/src/test/java/org/vast/sensorML/test/TestSMLBindingsV20.java">JUnit Test Class</a> so you can look at the code directly</i></p> 
 <div class="section"> 
  <h3 id="High-Level_Descriptive_Info">High-Level Descriptive Info</h3> 
  <p>The first thing you need to do to create or add to a SensorML description is to instantiate SML and SWE helperfactories:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>SMLHelper smlFac = new SMLHelper();
SWEHelper sweFac = new SWEHelper();
</pre> 
   </div> 
  </div> 
  <p>Then, if you don’t already have one, create the top level process or system instance. For instance a <tt>PhysicalSystem</tt> entity is created like so:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>PhysicalSystem system = smlFac.newPhysicalSystem();
</pre> 
   </div> 
  </div> 
  <p>You can then set name and description of the system:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>system.setName(&quot;Garage Thermometer&quot;);
system.setDescription(&quot;Thermometer located next to the door inside my garage&quot;);
</pre> 
   </div> 
  </div> 
  <p>You can also set the parent type of this sensor (this is typically used to reference a SensorML description providing more details about the sensor such as the SensorML document/datasheet provided by the manufacturer):</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>system.setTypeOf(new ReferenceImpl(&quot;http://manufacturer.org/datasheets/sensor1234.xml&quot;));
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Advanced_Metadata">Advanced Metadata</h3> 
  <p>Add contact information:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>ContactList contacts = smlFac.newContactList();
CIResponsibleParty contact = smlFac.newResponsibleParty();
contact.setIndividualName(&quot;G&eacute;rard Blanquet&quot;);
contact.setOrganisationName(&quot;Time Soft S.A.&quot;);
contact.getContactInfo().getAddress().addDeliveryPoint(&quot;10 rue du Nord&quot;);
contact.getContactInfo().getAddress().setPostalCode(&quot;75896&quot;);
contact.getContactInfo().getAddress().setCity(&quot;Paris&quot;);
contact.getContactInfo().getAddress().setCountry(&quot;FRANCE&quot;);
contact.setRole(new CodeListValueImpl(&quot;operator&quot;));
contacts.addContact(contact);
system.addContacts(contacts);
</pre> 
   </div> 
  </div> 
  <p>Add characteristics:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>CharacteristicList mechSpecs = smlFac.newCharacteristicList();
Quantity weightSpec = sweFac.newQuantity(&quot;http://sweet.jpl.nasa.gov/2.3/propMass.owl#Mass&quot;, &quot;Weight&quot;, null, &quot;kg&quot;);
weightSpec.setValue(12.3);
mechSpecs.addCharacteristic(&quot;weight&quot;, weightSpec);
system.addCharacteristics(&quot;mechanical&quot;, mechSpecs);
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Location">Location</h3> 
  <p>Add location as GML point:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>GMLFactory gmlFac = new GMLFactory();
Point pos = gmlFac.newPoint();
pos.setId(&quot;P01&quot;);
pos.setSrsName(&quot;http://www.opengis.net/def/crs/EPSG/0/4979&quot;);
pos.setPos(new double[] {45.6, 2.3, 193.2});
system.addPositionAsPoint(pos);
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="InputsOutputsParameters">Inputs/Outputs/Parameters</h3> 
  <p>All inputs, outputs and parameters in SensorML are described using the SWE Common Language so you can use the <tt>SWEHelper</tt> class to create these structures. </p> 
  <p>Add observable property as input:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>ObservableProperty obs = new ObservablePropertyImpl();
obs.setDefinition(&quot;http://mmisw.org/ont/cf/parameter/weather&quot;);
system.addInput(&quot;weather_phenomena&quot;, obs);
</pre> 
   </div> 
  </div> 
  <p>You can also add an input as xlink reference:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>system.getInputList().add(&quot;rain&quot;, &quot;http://remotedef.xml&quot;, null);
</pre> 
   </div> 
  </div> 
  <p>Add output record (in this case we first create the record object and then add sub-components to it, before we add it as output):</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>// create output record and set description
DataRecord rec = sweFac.newDataRecord();
rec.setLabel(&quot;Weather Data Record&quot;);
rec.setDescription(&quot;Record of synchronous weather measurements&quot;);

// sampling time
rec.addField(&quot;time&quot;, sweFac.newTimeStampIsoUTC());

// temperature measurement
rec.addField(&quot;temp&quot;, sweFac.newQuantity(
                            &quot;http://mmisw.org/ont/cf/parameter/air_temperature&quot;, 
                            &quot;Air Temperature&quot;, null, &quot;Cel&quot;));

// pressure
rec.addField(&quot;press&quot;, sweFac.newQuantity(
                            &quot;http://mmisw.org/ont/cf/parameter/air_pressure_at_sea_level&quot;,
                            &quot;Air Pressure&quot;, null, &quot;mbar&quot;));

// wind speed
rec.addField(&quot;wind_speed&quot;, sweFac.newQuantity(
                            &quot;http://mmisw.org/ont/cf/parameter/wind_speed&quot;,
                            &quot;Wind Speed&quot;, null, &quot;km/h&quot;));
        
// wind direction
rec.addField(&quot;wind_dir&quot;, sweFac.newQuantity(
                            &quot;http://mmisw.org/ont/cf/parameter/wind_to_direction&quot;,
                            &quot;Wind Direction&quot;, null, &quot;deg&quot;));

// add as output
system.addOutput(&quot;weather_data&quot;, rec);
</pre> 
   </div> 
  </div> 
  <p>You can also add accuracy info to some of the measured outputs:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>// add accuracy info to temp output
Quantity acc = sweFac.newQuantity(
                      &quot;http://mmisw.org/ont/cf/parameter/accuracy&quot;,
                      &quot;Accuracy&quot;, null, &quot;%&quot;);
(Quantity)rec.getField(&quot;temp&quot;)).addQuality(acc);
</pre> 
   </div> 
  </div> 
  <p>Parameters can be added in a similar fashion:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>system.addParameter(&quot;samplingPeriod&quot;, sweFac.newQuantity(
                       &quot;http://sensorml.com/ont/swe/property/SamplingPeriod&quot;,
                       &quot;Sampling Period&quot;, null, &quot;s&quot;));
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Reference_Frames">Reference Frames</h3> 
  <p>One important information that can be added to a sensor or system description is documentation about the reference frame that is attached to it. This is useful for properly processing positioning information in advanced geolocation workflows. Below is an example spatial reference frame definition:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>SpatialFrame systemFrame = smlFac.newSpatialFrame();
systemFrame.setId(&quot;SYSTEM_FRAME&quot;);
systemFrame.setLabel(&quot;System Reference Frame&quot;);
systemFrame.setDescription(&quot;Cartesian reference frame attached to system assembly&quot;);
systemFrame.setOrigin(&quot;Origin is located on the red marking at the bottom of the aluminum chassis&quot;);
systemFrame.addAxis(&quot;x&quot;, &quot;X axis is aligned with the horizontal edge of the chassis (see marking)&quot;);
systemFrame.addAxis(&quot;y&quot;, &quot;Y axis is orthogonal to both X and Y in order to form a direct orthogonal frame&quot;);
systemFrame.addAxis(&quot;z&quot;, &quot;Z axis is pointing toward the top of the assembly, aligned with the vertical edge of the aluminum frame&quot;);
system.addLocalReferenceFrame(systemFrame);
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Write-out_as_XML">Write-out as XML</h3> 
  <p>Once you have the java object tree created, it is trivial to serialize it as XML that is compliant to the SensorML standard:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>new SMLUtils().writeProcess(System.out, system, true);
</pre> 
   </div> 
  </div> 
 </div> 
</div>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#SWE_Common__SensorML_API" title="SWE Common / SensorML API">SWE Common / SensorML API <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#High-Level_Descriptive_Info" title="High-Level Descriptive Info">High-Level Descriptive Info</a>
		<li><a href="#Advanced_Metadata" title="Advanced Metadata">Advanced Metadata</a>
		<li><a href="#Location" title="Location">Location</a>
		<li><a href="#InputsOutputsParameters" title="Inputs/Outputs/Parameters">Inputs/Outputs/Parameters</a>
		<li><a href="#Reference_Frames" title="Reference Frames">Reference Frames</a>
		<li><a href="#Write-out_as_XML" title="Write-out as XML">Write-out as XML</a>
				<li class="divider"></li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span1 bottom-nav">
					<ul class="nav nav-list">
					</ul>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2015 <a href="http://www.sensiasoftware.com">Sensia Software LLC</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 1.0. </span><span class="publishDate">Last Published: 2015-10-18. </span></p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="../js/lightbox.min.js"></script>
	<script src="../js/reflow-scroll.js"></script>
	<script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="../js/reflow-skin.js"></script>

	</body>
</html>
